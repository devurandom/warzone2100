SELECT DISTINCTROW Structures.[Structure Name],
       StructureTypes.[Struct Name],
       [Technology Type].[Tecnology Name],
       [Structure Strength].[structure strength],
       Structures.TerrainType,
       Structures.[Base Width],
       Structures.[Base Breadth],
       [Foundation Types].[Foundation Name],
       Structures.[Build Points],
       Structures.Height,
       Structures.[Armour Value],
       Structures.[Body Points],
       Structures.[Repair System Points],
       Structures.[Power Usage],
       Structures.[Minimum Power],
       Structures.Resistance,
       Structures.[Quantity Limit],
       Structures.[Size Modifier],
       test4([ECMType]) AS [ECM Name],
       sensorName([SensorType]) AS [Sensor Name],
       Structures.[Weapon Slots],
       Structures.[Graphics filename0],
       Structures.[base plate name],
       DCount("[Structure Functions]![StructureID]","[Structure Functions]","[Structure Functions]![StructureID] = " & [StructureID]) AS TotalFunctions,
       DCount("[Structure Weapons]![StructureID]","[Structure Weapons]","[Structure Weapons]![StructureID] =" & [StructureID]) AS TotalWeapons
FROM Component INNER JOIN ECM ON Component.[Component ID] = ECM.[Component ID], ([Structure Strength] INNER JOIN (([Foundation Types] INNER JOIN Structures ON [Foundation Types].FoundationID = Structures.FoundationID) INNER JOIN StructureTypes ON Structures.NameID = StructureTypes.ID) ON [Structure Strength].id = Structures.[Structute Strength]) INNER JOIN [Technology Type] ON Structures.[TechnologyType ID] = [Technology Type].[TechnologyType ID]
ORDER BY Structures.[Structure Name];
